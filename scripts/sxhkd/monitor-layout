#!/bin/sh

XRANDR=$(command -v xrandr)
MONITORS=$( ${XRANDR} | awk '/ connected/ { print $1 }' )
NUM_MONITORS=$(echo "$MONITORS" | wc -w)

gen_xrandr_only() {
    selected="$1"
    cmd="xrandr --output ${MONITORS[$selected]} --auto"
    for entry in $MONITORS; do
        [ "$selected" != "$entry" ] && cmd="$cmd --output $entry --off"
    done
    echo "$cmd"
}

# Definimos la lista de opciones
OPTIONS="Cancel\n"
for entry_a in $MONITORS; do
    OPTIONS="${OPTIONS}Only $entry_a\n"
    for entry_b in $MONITORS; do
        [ "$entry_a" != "$entry_b" ] && OPTIONS="${OPTIONS}Dual Screen $entry_a -> $entry_b\n"
        [ "$entry_a" != "$entry_b" ] && OPTIONS="${OPTIONS}Clone Screen $entry_a -> $entry_b\n"
    done
done

# Seleccionamos la opción utilizando dmenu
CHOICE=$(echo -e "$OPTIONS" | dmenu -p "Monitor Setup:")

# Procesamos la elección
case "$CHOICE" in
    "Cancel") ;;
    *) eval "$(echo "${COMMANDS[$CHOICE]}")";;
esac
